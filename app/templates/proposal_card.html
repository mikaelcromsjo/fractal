<div class="card show">
<div class="proposal-card" data-proposal-id="${proposal['id']}">
    <!-- Header: avatar + name + date -->
    <div class="proposal-header-row">
        <div class="proposal-userblock">
            <img src="${user['avatar']}" alt="${proposal['username']}" class="proposal-avatar">
            <div class="proposal-usertext">
                <a _href="/profile/${proposal['id']}/"
                   data-uid="${proposal['id']}"
                   class="proposal-username usertooltip">
                    ${proposal['username']}
                </a>
                <div class="proposal-date">
                    ${proposal['date']}
                </div>
            </div>
        </div>

    </div>

    <!-- Title + description -->
    <div class="proposal-main">
        <h2 class="proposal-title">${proposal['title']}</h2>
        <p class="proposal-text">${proposal['message']}</p>

        % if proposal.get('tags'):
            <div class="proposal-tags">
                % for tag in proposal['tags']:
                    <span class="proposal-tag">#${tag}</span>
                % endfor
            </div>
        % endif
    </div>


<!-- Star Rating -->
        % if proposal['vote'] != -1:        
<div class="proposal-rating-block">
    <div class="proposal-star-rating" id="star-rating-${proposal['id']}">

            % for i in range(10):
                % if i < proposal['vote']:
                <span class="star active" data-rating="${i+1}" onclick="onStarRatingClick(${proposal['id']}, ${i+1})">⭐</span>
                % else:
                <span class="star faded" data-rating="${i+1}" onclick="onStarRatingClick(${proposal['id']}, ${i+1})">⭐</span>
             % endif
         % endfor
    </div>
</div>
% endif

    <!-- Comments list -->
    <div class="proposal-comments-block">
        <div class="proposal-comments-header">
            Comments
        </div>
        <div class="proposal-comments-list" id="comments-list-${proposal['id']}">
            % if proposal.get('comments'):
                % for comment in proposal['comments']:
                    <div class="proposal-comment-row">
                        <img src="${comment['avatar']}"
                             alt="${comment['username']}"
                             class="proposal-comment-avatar">
                        <div class="proposal-comment-content">
<div class="proposal-comment-top">
    <span>
    <div class="proposal-comment-username">
        ${comment['username']}
    </div>
    <div class="proposal-comment-date">
        ${comment['date']}
    </div>
    </span>



    
<!-- Star Rating Comment -->
        % if comment['vote'] != -1:
<div class="comment-rating-block">
    <div class="comment-star-rating" id="comment-star-rating-${comment['id']}">
            % for i in range(3):
                % if i < comment['vote']:
                <span class="star comment-star active" data-rating="${i+1}" onclick="onStarRatingCommentClick(${comment['id']}, ${i+1})">⭐</span>
                % else:
                <span class="star comment-star faded" data-rating="${i+1}" onclick="onStarRatingCommentClick(${comment['id']}, ${i+1})">⭐</span>
                % endif
            % endfor
    </div>
</div>
        % endif

</div>
            <div class="proposal-comment-text">
                ${comment['text']}
            </div>
                        </div>
                    </div>
                % endfor
            % else:
                <div class="proposal-comment-empty">
                    No comments yet.
                </div>
            % endif
        </div>

        <!-- Comment input -->
        <div class="proposal-comment-input-row">
            <textarea
                class="proposal-comment-input"
                id="comment-input-${proposal['id']}"
                rows="1"
                placeholder="Add a comment..."
                onkeydown="if(event.key==='Enter' && !event.shiftKey){event.preventDefault();submitProposalComment(${proposal['id']});}"></textarea>
            <button
                type="button"
                class="proposal-comment-send-btn"
                onclick="submitProposalComment(${proposal['id']});">
                Send
            </button>
        </div>
    </div>
</div>
</div>